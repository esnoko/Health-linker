"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5316],{5316:(R,m,l)=>{l.r(m),l.d(m,{AppointmentsPageModule:()=>I});var p=l(177),v=l(4341),a=l(1075),h=l(9591),g=l(467),F=l(8032),u=l.n(F),e=l(4438),y=l(4163),b=l(9579),k=l(2406),_=l(7959);const d=s=>({selected:s});function A(s,n){if(1&s&&(e.j41(0,"ion-select-option",18),e.EFF(1),e.k0s()),2&s){const i=n.$implicit;e.Y8G("value",i),e.R7$(),e.SpI(" ",i.payload.doc.data().FullNames,"")}}function D(s,n){if(1&s&&(e.j41(0,"ion-select-option"),e.EFF(1),e.k0s()),2&s){const i=n.$implicit;e.R7$(),e.JRh(i)}}function C(s,n){if(1&s){const i=e.RV6();e.j41(0,"div",19),e.bIt("click",function(){const o=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.selectDate(o))}),e.j41(1,"ion-text")(2,"h1",20),e.EFF(3),e.nI1(4,"date"),e.k0s()(),e.j41(5,"ion-text")(6,"h1",20),e.EFF(7),e.nI1(8,"date"),e.k0s()()()}if(2&s){const i=n.$implicit,t=e.XpG();e.Y8G("ngClass",e.eq3(9,d,t.selectedDate===i)),e.R7$(3),e.JRh(e.i5U(4,3,i,"EEE")),e.R7$(4),e.JRh(e.i5U(8,6,i,"d"))}}function j(s,n){if(1&s){const i=e.RV6();e.j41(0,"div",21),e.bIt("click",function(){const o=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.selectTime(o))}),e.j41(1,"ion-text")(2,"h1",22),e.EFF(3),e.k0s()()()}if(2&s){const i=n.$implicit,t=e.XpG();e.Y8G("ngClass",e.eq3(2,d,t.selectedTime===i)),e.R7$(3),e.JRh(i)}}function x(s,n){if(1&s){const i=e.RV6();e.j41(0,"ion-item",23),e.bIt("click",function(){const o=e.eBV(i).$implicit,r=e.XpG();return e.Njj(r.selectHospital(o.hospital_name))}),e.j41(1,"ion-label",24),e.EFF(2),e.k0s()()}if(2&s){const i=n.$implicit,t=e.XpG();e.Y8G("ngClass",e.eq3(2,d,t.selectedHospital===i.hospital_name)),e.R7$(2),e.JRh(i.hospital_name)}}const T=[{path:"",component:(()=>{var s;class n{constructor(t,o,r,c,f){this.loadingCtrl=t,this.firestore=o,this.utils=r,this._router=c,this.hospitalsJson=f,this.date=!1,this.time=!1,this.hospital=!1,this.selectedDate=null,this.selectedTime=null,this.times=["09h00 - 10h00","10h00 - 11h00","12h00 - 13h00"],this.selectedHospital=null,this.hospitals=[],this.bookingTypes=["General","Dentist","Social Worker","Optimetrist"],this.weekDates=[]}ngOnInit(){const t=localStorage.getItem("hUser");this.user=JSON.parse(t),console.log(this.user),this.uid=localStorage.getItem("hUserId"),this.weekDates=this.generateWeekDates(),this.getFamilyMembers(),this.getAllHospitals()}getAllHospitals(){this.hospitalsJson.getHospitals().subscribe({next:t=>{t&&t.hospitals?this.hospitals=t.hospitals.filter(o=>"YES"===o.available):console.error("Data structure is incorrect:",t)},error:t=>{console.error("Error occurred:",t)}})}showLoading(){var t=this;return(0,g.A)(function*(){const o=yield t.loadingCtrl.create({message:"Loading...",duration:2e3});return yield o.present(),o})()}generateWeekDates(){const t=[],o=new Date;let r=1;for(;t.length<6;){const c=new Date(o);c.setDate(o.getDate()+r),0!==c.getDay()&&t.push(c),r++}return t}selectDate(t){this.selectedDate=t,console.log(this.selectedDate)}selectTime(t){this.selectedTime=t,console.log(this.selectedTime)}selectHospital(t){this.selectedHospital=t,console.log(this.selectedHospital)}bookingAppointment(){var t=this;return(0,g.A)(function*(){if(t.selectedTime&&t.selectedDate&&t.selectedHospital){t.utils.showSpinner();const o={date:t.selectedDate,time:t.selectedTime,hospital:t.selectedHospital,Status:"New",Type:t.type,BookedBy:t.uid,clientId:t.userId,clientNames:t.FullNames};t.firestore.setData("Appointments",o).then(r=>{t.utils.hideSpinner(),u().fire({title:"Appointment booked",text:"At : "+o.hospital,icon:"success"}),t.firestore.nitifications(t.uid,{title:"Appointment booked",msg:"For "+o.clientNames+" at :"+o.hospital}),t._router.navigateByUrl("client/home/my-appointments")}),console.log("Appointmet details : ",o)}})()}showswal(){if(this.selectedDate&&this.selectedTime&&this.selectedHospital){const t=`\n        Date: ${this.selectedDate.toDateString()}\n        Time: ${this.selectedTime}\n        Hospital: ${this.selectedHospital}\n        Type: ${this.type}\n      `;u().fire({title:"Confirm Booking",html:`<pre class="text-left whitespace-pre-line text-base text-gray-600">${t} </pre>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#00A791",cancelButtonColor:"#d33",confirmButtonText:"Yes, book!"}).then(o=>{o.isConfirmed&&this.bookingAppointment()})}}getFamilyMembers(){this.firestore.readWhereFilter("Users","CreatedBy",this.uid,"==").snapshotChanges().subscribe(t=>{console.log(t),this.FamilyMembers=t})}onSelectChange(t){console.log("Selected value:",t.detail.value);const o=t.detail.value;"myself"==t.detail.value?(this.userId=this.uid,this.user&&(this.FullNames=this.user.FullNames),console.log("User ID",this.userId,"User Data ",this.FullNames)):(console.log("Data ",o.payload.doc.id),this.userId=o.payload.doc.id,this.FullNames=o.payload.doc.data().FullNames,console.log("User ID",this.userId,"User Data ",this.FullNames))}onTypeSelected(t){this.type=t.detail.value}}return(s=n).\u0275fac=function(t){return new(t||s)(e.rXU(a.Xi),e.rXU(y.B),e.rXU(b.T),e.rXU(h.Ix),e.rXU(k.l))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-appointments"]],decls:33,vars:6,consts:[[1,"ion-no-border"],["color","primary"],["slot","start"],["color","light",3,"fullscreen"],[1,"w-full","flex","flex-col","p-2"],[1,"flex","text-health-green","p-2","text-xl","text-health_blue-1"],["mode","ios","placeholder","Choose a family member",1,"px-2","border-health_green","border","rounded-lg","w-full",3,"ionChange"],["value","myself"],[3,"value",4,"ngFor","ngForOf"],["mode","ios","placeholder","Booking Type",1,"px-2","border-health_green","border","rounded-lg","w-full",3,"ionChange"],[4,"ngFor","ngForOf"],[1,"w-full","p-2","flex","space-x-2"],["class","flex flex-col justify-center items-center p-4 bg-health_blue-2\n border-gray-500 rounded-lg w-14 h-14 hover:bg-green-400",3,"ngClass","click",4,"ngFor","ngForOf"],["class","flex flex-col justify-center items-center p-4\n   bg-health_blue-2 border-gray-500 rounded-lg w-25 h-10 hover:bg-green-400",3,"ngClass","click",4,"ngFor","ngForOf"],["inset","true"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"w-full","px-2"],["btnText","Book Appointment",3,"click"],[3,"value"],[1,"flex","flex-col","justify-center","items-center","p-4","bg-health_blue-2","border-gray-500","rounded-lg","w-14","h-14","hover:bg-green-400",3,"click","ngClass"],[1,"font-normal","text-xl","text-black"],[1,"flex","flex-col","justify-center","items-center","p-4","bg-health_blue-2","border-gray-500","rounded-lg","w-25","h-10","hover:bg-green-400",3,"click","ngClass"],[1,"font-normal","text-black","text-xs"],[3,"click","ngClass"],[1,"uppercase"]],template:function(t,o){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e.nrm(3,"ion-back-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Make Appointment"),e.k0s()()(),e.j41(6,"ion-content",3)(7,"div",4)(8,"h1",5),e.EFF(9,"Book for"),e.k0s(),e.j41(10,"ion-select",6),e.bIt("ionChange",function(c){return o.onSelectChange(c)}),e.j41(11,"ion-select-option",7),e.EFF(12,"My Self"),e.k0s(),e.DNE(13,A,2,2,"ion-select-option",8),e.k0s()(),e.j41(14,"div",4)(15,"ion-select",9),e.bIt("ionChange",function(c){return o.onTypeSelected(c)}),e.DNE(16,D,2,1,"ion-select-option",10),e.k0s()(),e.j41(17,"div")(18,"h1",5),e.EFF(19,"Choose Date"),e.k0s()(),e.j41(20,"div",11),e.DNE(21,C,9,11,"div",12),e.k0s(),e.j41(22,"h1",5),e.EFF(23,"Choose Time"),e.k0s(),e.j41(24,"div",11),e.DNE(25,j,4,4,"div",13),e.k0s(),e.j41(26,"h1",5),e.EFF(27,"Available Hospitals"),e.k0s(),e.j41(28,"div")(29,"ion-list",14),e.DNE(30,x,3,4,"ion-item",15),e.k0s()(),e.j41(31,"div",16)(32,"app-button",17),e.bIt("click",function(){return o.showswal()}),e.k0s()()()),2&t&&(e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(7),e.Y8G("ngForOf",o.FamilyMembers),e.R7$(3),e.Y8G("ngForOf",o.bookingTypes),e.R7$(5),e.Y8G("ngForOf",o.weekDates),e.R7$(4),e.Y8G("ngForOf",o.times),e.R7$(5),e.Y8G("ngForOf",o.hospitals))},dependencies:[p.YU,p.Sq,_.Q,a.QW,a.W9,a.eU,a.uz,a.he,a.nf,a.Nm,a.Ip,a.IO,a.BC,a.ai,a.Je,a.el,p.vh],styles:[".selected[_ngcontent-%COMP%]{background-color:rgb(252 165 165/var(--tw-bg-opacity));color:#4ade80}ion-label[_ngcontent-%COMP%]:hover{color:#4ade80}"]}),n})()}];let P=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[h.iI.forChild(T),h.iI]}),n})();var $=l(5553);let I=(()=>{var s;class n{}return(s=n).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[p.MD,$.h,v.YN,a.bv,P]}),n})()}}]);